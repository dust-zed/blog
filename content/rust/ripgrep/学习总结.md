+++
date = '2025-08-28T03:08:15+08:00'
draft = true
title = '学习总结'
categories = ['rust']

+++

### 声明

此篇为草稿，暂时性的总结下这段时间学到的一些小知识

#### 架构设计

* 如何做好职责分离
  * 从“怎么实现”到“怎么组合”
    * 一体式思维：我要写一个函数完成所有功能
    * 分离式思维：我要设计几个组件，然后组合它们实现
  * 从“功能优先”到“测试优先”
    * 一体式思维：先实现功能，再考虑测试
    * 分离式思维：先考虑怎么测试，倒推出职责分离
* ripgrep的分离式架构
  * cli参数 → LowArgs → HiArgs
  * 搜索目标：分为文件发现和目标搜索
  * 文件遍历再次分离：WalkDir（负责目录树形结构转为线性的Iter）→ WalkEventDir（负责发送事件）→ Walk（添加忽略规则）

#### rust语法

* `drain`：核心功能是移除集合中指定范围的元素，同时保持集合的连续性，是一种比多次调用remove()更高效的批量处理方式
* `std::thread::scope`： 相当于`thread::spawn` + `thread::join`，但是它们只能借用`'static`或者`move`变量；`scope`没有这个限制，有编译器的支持
* (PathBuf, Path)和(String, str)类比，
  * Path是DST
  * 文件路径长度在编译时未知
  * 不同平台，不同用户的路径长度差异很大

#### 文件系统

* metadata:本质上就是描述文件信息的数据
* 环境变量和配置文件
  * 配置文件：存储**默认配置**或**静态配置**
  * 环境变量：提供**动态覆盖**或**环境特定配置**
* **挂载（Mount）**： 将**存储设备**或**文件系统**连接到操作系统目录树中特定位置的过程。这个连接点称为**挂载点（Mount Point）**。类比门和仓库的关系。
* 文件设备号
